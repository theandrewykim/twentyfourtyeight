var Game=function(r){var o=this.randomBoard();this.boardArray=r||o,this.score=0},highScore=0;Game.prototype.randomBoard=function(){var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=Math.floor(4*Math.random()+1);for(i=0;i<o;i++)r[Math.floor(16*Math.random())]=2;return r},Game.prototype.toString=function(){printArray=this.boardArray.slice(0),printArray.splice(4,0,"\n"),printArray.splice(9,0,"\n"),printArray.splice(14,0,"\n"),console.log(printArray.join(""))},Game.prototype.spawnBlock=function(){var r=Math.floor(16*Math.random());return 0!==this.boardArray[r]?this.spawnBlock():(this.boardArray[r]=2,this.boardArray)},Game.prototype.rows=function(){return row1=this.boardArray.slice(0,4),row2=this.boardArray.slice(4,8),row3=this.boardArray.slice(8,12),row4=this.boardArray.slice(12,16),[row1,row2,row3,row4]};var slide=function(r){var o=!0,a=!1,t=undefined;try{for(var i,e=r[Symbol.iterator]();!(o=(i=e.next()).done);o=!0)for(var s=i.value,n=1;n<s.length;n++)0===s[n-1]&&(s[n-1]=s[n],s[n]=0)}catch(r){a=!0,t=r}finally{try{!o&&e["return"]&&e["return"]()}finally{if(a)throw t}}return _.flatten(r)},reverserows=function(r){var o=!0,a=!1,t=undefined;try{for(var i,e=r[Symbol.iterator]();!(o=(i=e.next()).done);o=!0){i.value.reverse()}}catch(r){a=!0,t=r}finally{try{!o&&e["return"]&&e["return"]()}finally{if(a)throw t}}return r};Game.prototype.left=function(){return boardArrays=this.rows(),this.boardArray=slide(boardArrays)},Game.prototype.combine=function(){boardArrays=this.rows();var r=!0,o=!1,a=undefined;try{for(var t,i=boardArrays[Symbol.iterator]();!(r=(t=i.next()).done);r=!0)for(var e=t.value,s=1;s<e.length;s++)if(e[s-1]===e[s]){var n=parseInt(e[s])+parseInt(e[s-1]);e[s-1]=n,e[s]=0,this.score+=n,this.boardArray=_.flatten(boardArrays)}}catch(r){o=!0,a=r}finally{try{!r&&i["return"]&&i["return"]()}finally{if(o)throw a}}},Game.prototype.move=function(r){var o=this.boardArray;if("left"===r){for(;this.boardArray.join("")!=this.left().join("");)this.left();this.combine(),this.left()}else if("right"===r){for(var a=reverserows(this.rows());this.boardArray.join("")!=slide(a).join("");)this.boardArray=slide(a);this.combine(),this.boardArray=slide(this.rows()),this.boardArray=_.flatten(reverserows(this.rows()))}else if("up"===r){for(var t=_.zip.apply(null,this.rows());this.boardArray.join("")!=slide(t).join("");)this.boardArray=slide(t);this.combine(),this.boardArray=slide(this.rows());var i=_.zip.apply(null,this.rows());this.boardArray=_.flatten(i)}else if("down"===r){for(var t=_.zip.apply(null,this.rows()),e=reverserows(t);this.boardArray.join("")!=slide(e).join("");)this.boardArray=slide(e);this.combine(),this.boardArray=slide(this.rows());var s=reverserows(this.rows()),n=_.zip.apply(null,s);this.boardArray=_.flatten(n)}return o.join("")===this.boardArray.join("")?this.boardArray:(this.spawnBlock(),this.boardArray)},Game.prototype.gameOver=function(){var r=this.boardArray.slice(0),o=new Game(r);r.includes(2048)?alert("You Win! Your final score was:"+100*this.score):r.join("")===o.move("left").join("")&&r.join("")===o.move("right").join("")&&r.join("")===o.move("down").join("")&&r.join("")===o.move("up").join("")&&alert("You Suck! Your final score was: "+100*this.score)};var game=new Game;